<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>dicktaint | private local dictation</title>
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Archivo+Black&family=Space+Grotesk:wght@400;500;700&display=swap"
      rel="stylesheet"
    />
    <link rel="stylesheet" href="/styles.css" />
  </head>
  <body>
    <main class="app-shell" data-screen="onboarding">
      <header class="app-header">
        <p class="eyebrow">PRIVATE LOCAL DICTATION</p>
        <h1>dicktaint</h1>
      </header>

      <section id="onboardingScreen" class="screen">
        <article class="panel intro-card">
          <div class="setup-header">
            <p id="setupModeChip" class="chip">ONBOARDING</p>
            <button id="backToDictation" class="ghost" type="button" hidden>Back to Dictation</button>
          </div>
          <h2 id="setupTitle">Set up local speech-to-text</h2>
          <p id="setupLead" class="hint">
            Everything runs on-device. Pick a model, download it once, and this machine is ready.
          </p>
          <ol id="setupSteps" class="setup-steps">
            <li>Check whisper-cli + machine profile.</li>
            <li>Pick a model sized for this device.</li>
            <li>Tap Download + Use, then start dictation.</li>
          </ol>
          <div class="setup-health" aria-live="polite">
            <span id="whisperCliHealth" class="health-pill" data-state="pending">whisper-cli: checking</span>
            <span id="dictationModelHealth" class="health-pill" data-state="pending">model: checking</span>
          </div>
          <p id="dictationDeviceProfile" class="hint"></p>
        </article>

        <section id="dictationModelCard" class="panel model-onboarding" hidden>
          <label for="dictationModelSelect">Local Speech Model</label>
          <div class="inline-actions">
            <select id="dictationModelSelect"></select>
            <button id="installDictationModel" class="secondary" type="button">Download + Use</button>
          </div>
          <p id="dictationModelMeta" class="hint model-meta"></p>
          <div class="dictation-setup-actions">
            <button id="deleteDictationModel" class="ghost danger-btn" type="button">Delete Local Model</button>
            <button id="retryWhisperCheck" class="ghost" type="button">Refresh Setup</button>
            <button id="openWhisperSetup" class="ghost quiet" type="button" hidden>Open CLI Setup (dev)</button>
          </div>
          <section id="dictationHotkeyCard" class="hotkey-card" hidden>
            <label for="dictationHotkeyInput">Dictation Hotkey</label>
            <p class="hint">Press one combo to toggle dictation start/stop.</p>
            <div class="hotkey-editor">
              <input id="dictationHotkeyInput" type="text" readonly placeholder="CmdOrCtrl+Shift+D" />
              <button id="recordDictationHotkey" class="secondary" type="button">Record</button>
            </div>
            <div class="dictation-setup-actions">
              <button id="saveDictationHotkey" class="ghost" type="button">Save Hotkey</button>
              <button id="resetDictationHotkey" class="ghost" type="button">Reset Default</button>
              <button id="clearDictationHotkey" class="ghost danger-btn" type="button">Disable Hotkey</button>
            </div>
            <p id="dictationHotkeyStatus" class="hint">No hotkey configured yet.</p>
          </section>
          <section id="focusedFieldInsertCard" class="hotkey-card" hidden>
            <label for="focusedFieldInsertToggle">Dictate Into Focused Field</label>
            <p class="hint">When enabled, finished transcripts are pasted into the currently focused field.</p>
            <label class="toggle-row" for="focusedFieldInsertToggle">
              <input id="focusedFieldInsertToggle" type="checkbox" />
              <span>Enable focused-field insertion</span>
            </label>
            <p id="focusedFieldInsertStatus" class="hint">Focused-field insertion is disabled.</p>
          </section>
          <p id="dictationModelBusy" class="hint busy-note" hidden></p>
          <p id="dictationModelStatus" class="hint"></p>
          <p class="hint setup-note">
            Dev helper: <code>bun run whisper:sidecar</code> then <code>bun run whisper:smoke</code>.
          </p>
        </section>

        <div class="screen-actions">
          <button id="onboardingContinue" class="primary" type="button">Start Dictation</button>
        </div>
      </section>

      <section id="dictationScreen" class="screen" hidden>
        <article class="panel dictation-card">
          <div class="dictation-head">
            <div>
              <h2>Dictation</h2>
              <p class="hint">Tap start, speak, then stop to transcribe locally.</p>
            </div>
            <button id="openSettings" class="ghost" type="button">Settings</button>
          </div>
          <div class="dictation-actions">
            <button id="startDictation" class="primary" type="button">Start Dictation</button>
            <button id="stopDictation" class="secondary" type="button" disabled>Stop</button>
            <button id="clearTranscript" class="ghost" type="button">Clear</button>
          </div>
          <div class="waveform" aria-hidden="true">
            <span class="waveform-bar" style="--i:0"></span>
            <span class="waveform-bar" style="--i:1"></span>
            <span class="waveform-bar" style="--i:2"></span>
            <span class="waveform-bar" style="--i:3"></span>
            <span class="waveform-bar" style="--i:4"></span>
            <span class="waveform-bar" style="--i:5"></span>
            <span class="waveform-bar" style="--i:6"></span>
            <span class="waveform-bar" style="--i:7"></span>
            <span class="waveform-bar" style="--i:8"></span>
            <span class="waveform-bar" style="--i:9"></span>
            <span class="waveform-bar" style="--i:10"></span>
            <span class="waveform-bar" style="--i:11"></span>
          </div>
          <label for="transcriptInput">Transcript</label>
          <textarea id="transcriptInput" rows="10" placeholder="Your dictated text appears here..."></textarea>
          <section id="dictationHistorySection" class="dictation-history" aria-label="Recent Dictations">
            <div class="dictation-history-head">
              <h3>Recent Dictations</h3>
              <button id="clearDictationHistory" class="ghost quiet" type="button">Clear History</button>
            </div>
            <p id="dictationHistoryEmpty" class="hint">No saved dictations yet.</p>
            <ul id="dictationHistoryList" class="dictation-history-list"></ul>
          </section>
        </article>
      </section>

      <footer class="status-bar" role="status" aria-live="polite">
        <p class="status-label">Status</p>
        <p id="status">Loading local-first setup...</p>
      </footer>
    </main>

    <button id="quickDictationFab" class="fab-glass" type="button" aria-label="Start dictation">
      <svg class="fab-icon" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" aria-hidden="true">
        <rect x="9" y="2" width="6" height="12" rx="3" fill="currentColor"/>
        <path d="M5 11a7 7 0 0 0 14 0" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
        <line x1="12" y1="18" x2="12" y2="22" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
        <line x1="9" y1="22" x2="15" y2="22" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
      </svg>
      <span class="fab-label">Dictate</span>
      <span class="fab-wave" aria-hidden="true">
        <span class="fab-wave-bar" style="--i:0"></span>
        <span class="fab-wave-bar" style="--i:1"></span>
        <span class="fab-wave-bar" style="--i:2"></span>
        <span class="fab-wave-bar" style="--i:3"></span>
        <span class="fab-wave-bar" style="--i:4"></span>
      </span>
      <svg class="fab-spinner" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" aria-hidden="true">
        <circle cx="12" cy="12" r="9" stroke="rgba(47,192,163,0.25)" stroke-width="2"/>
        <path d="M12 3a9 9 0 0 1 9 9" stroke="#2fc0a3" stroke-width="2" stroke-linecap="round"/>
      </svg>
      <span class="fab-shimmer" aria-hidden="true"></span>
    </button>

    <script src="/app.js" defer></script>
  </body>
</html>
